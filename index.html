<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Yearly Life Betterment Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #020617;
      --bg-elevated: #0b1120;
      --accent: #22c55e;
      --accent-soft: rgba(34, 197, 94, 0.14);
      --text-main: #f9fafb;
      --text-muted: #9ca3af;
      --border-subtle: #1f2937;
      --danger: #ef4444;
    }
    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1f2937, #020617 55%);
      color: var(--text-main);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .app-shell {
      flex: 1;
      max-width: 1100px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
    }
    header {
      padding: 14px 14px 6px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }
    .title-block {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .title-block h1 {
      margin: 0;
      font-size: 1.05rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }
    .title-block span {
      font-size: 0.75rem;
      color: var(--text-muted);
    }
    .pill {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      padding: 6px 10px;
      font-size: 0.75rem;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: var(--text-muted);
      background: rgba(15, 23, 42, 0.9);
    }
    .pill-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 0 6px rgba(34, 197, 94, 0.25);
    }
    main {
      flex: 1;
      padding: 0 10px 70px;
    }

    /* Group + tab nav */
    .group-strip {
      display: flex;
      gap: 8px;
      padding: 4px 0 6px;
      overflow-x: auto;
      scrollbar-width: none;
    }
    .group-strip::-webkit-scrollbar {
      display: none;
    }
    .group-chip {
      white-space: nowrap;
      padding: 6px 12px;
      border-radius: 999px;
      border: 1px solid var(--border-subtle);
      background: rgba(15, 23, 42, 0.9);
      font-size: 0.8rem;
      color: var(--text-muted);
      cursor: pointer;
      flex-shrink: 0;
    }
    .group-chip.active {
      background: var(--accent-soft);
      border-color: var(--accent);
      color: var(--text-main);
      font-weight: 600;
    }

    .tab-strip {
      display: flex;
      gap: 6px;
      padding: 0 0 8px;
      overflow-x: auto;
      scrollbar-width: none;
    }
    .tab-strip::-webkit-scrollbar {
      display: none;
    }
    .tab-chip {
      white-space: nowrap;
      padding: 5px 10px;
      border-radius: 999px;
      border: 1px solid var(--border-subtle);
      background: rgba(15, 23, 42, 0.9);
      font-size: 0.75rem;
      color: var(--text-muted);
      cursor: pointer;
      flex-shrink: 0;
    }
    .tab-chip.active {
      background: rgba(34, 197, 94, 0.18);
      border-color: var(--accent);
      color: var(--text-main);
      font-weight: 600;
    }

    /* Card & table */
    .card {
      background: rgba(15, 23, 42, 0.96);
      border-radius: 18px;
      border: 1px solid var(--border-subtle);
      box-shadow:
        0 18px 45px rgba(0, 0, 0, 0.6),
        0 0 0 1px rgba(148, 163, 184, 0.18) inset;
      padding: 12px;
      margin-top: 4px;
    }
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }
    .card-header h2 {
      margin: 0;
      font-size: 0.95rem;
    }
    .card-header span {
      font-size: 0.75rem;
      color: var(--text-muted);
    }
    .badge {
      border-radius: 999px;
      padding: 5px 10px;
      border: 1px solid var(--border-subtle);
      font-size: 0.7rem;
      color: var(--text-muted);
      background: rgba(15, 23, 42, 0.9);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .badge span {
      color: var(--accent);
    }

    .week-pill {
      border-radius: 999px;
      padding: 5px 10px;
      border: 1px solid var(--border-subtle);
      font-size: 0.8rem;
      color: var(--text-muted);
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      background: rgba(15, 23, 42, 0.9);
    }
    .week-pill strong {
      color: var(--text-main);
      font-weight: 500;
    }

    .table-wrapper {
      margin-top: 4px;
      border-radius: 12px;
      background: radial-gradient(circle at top left, rgba(34, 197, 94, 0.16), rgba(15, 23, 42, 0.94));
      overflow: auto;
      border: 1px solid rgba(31, 41, 55, 0.95);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.75rem;
      min-width: 100%;
    }
    thead {
      background: linear-gradient(to right, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.75));
      position: sticky;
      top: 0;
      z-index: 1;
    }
    th, td {
      padding: 6px 4px;
      text-align: center;
      border-bottom: 1px solid rgba(31, 41, 55, 0.9);
    }
    th:first-child, td:first-child {
      text-align: left;
      padding-left: 10px;
    }
    tbody tr:last-child td {
      border-bottom: none;
    }
    tbody tr:nth-child(even) {
      background: rgba(15, 23, 42, 0.85);
    }
    tbody tr:nth-child(odd) {
      background: rgba(15, 23, 42, 0.7);
    }

    .category-label {
      font-weight: 500;
      font-size: 0.78rem;
    }
    .category-label span {
      display: block;
      font-size: 0.7rem;
      color: var(--text-muted);
      font-weight: 400;
    }

    input.small-input,
    input.log-input,
    select.log-input,
    textarea.log-input {
      width: 100%;
      padding: 4px 4px;
      border-radius: 8px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: rgba(15, 23, 42, 0.9);
      color: var(--text-main);
      font-size: 0.72rem;
    }
    input.small-input {
      max-width: 56px;
      text-align: center;
    }
    input.small-input:focus,
    input.log-input:focus,
    select.log-input:focus,
    textarea.log-input:focus {
      outline: 1px solid var(--accent);
      box-shadow: 0 0 0 1px rgba(34, 197, 94, 0.4);
    }
    textarea.log-input {
      resize: vertical;
      min-height: 52px;
    }

    .summary-row {
      background: rgba(15, 23, 42, 1);
    }
    .summary-row td {
      font-size: 0.75rem;
      color: var(--text-muted);
      border-top: 1px solid rgba(31, 41, 55, 0.95);
    }
    .summary-label {
      font-weight: 500;
      color: var(--text-main);
    }
    .summary-value {
      color: var(--accent);
      font-weight: 500;
      text-align: right;
      padding-right: 12px;
    }

    .controls-row {
      display: flex;
      flex-wrap: wrap;
      justify-content: flex-end;
      gap: 6px;
      margin-top: 6px;
      font-size: 0.7rem;
    }
    .btn {
      border-radius: 999px;
      padding: 5px 10px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      background: rgba(15, 23, 42, 0.98);
      color: var(--text-muted);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .btn-primary {
      border-color: var(--accent);
      background: var(--accent-soft);
      color: var(--text-main);
    }
    .btn-danger {
      border-color: rgba(239, 68, 68, 0.7);
      color: #fecaca;
    }

    .helper-text {
      margin-top: 8px;
      font-size: 0.7rem;
      color: var(--text-muted);
      display: flex;
      align-items: flex-start;
      gap: 6px;
    }
    .helper-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--accent);
      margin-top: 4px;
    }

    .analytics-grid {
      margin-top: 10px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
      gap: 6px;
    }
    .analytics-card {
      border-radius: 12px;
      border: 1px solid rgba(31, 41, 55, 0.9);
      background: rgba(15, 23, 42, 0.96);
      padding: 6px 8px;
      font-size: 0.72rem;
    }
    .analytics-label {
      color: var(--text-muted);
    }
    .analytics-value {
      color: var(--accent);
      font-weight: 600;
      font-size: 0.8rem;
      margin-top: 2px;
    }

    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      max-width: 1100px;
      margin: 0 auto;
      padding: 6px 9px 10px;
      background: linear-gradient(to top, rgba(15, 23, 42, 0.98), rgba(15, 23, 42, 0.94));
      border-top: 1px solid rgba(31, 41, 55, 0.95);
      display: flex;
      justify-content: space-between;
      gap: 6px;
      backdrop-filter: blur(18px);
    }
    .nav-btn {
      flex: 1;
      border-radius: 999px;
      padding: 6px 6px;
      border: 1px solid rgba(31, 41, 55, 0.9);
      background: rgba(15, 23, 42, 0.98);
      font-size: 0.7rem;
      color: var(--text-muted);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 2px;
      cursor: pointer;
    }
    .nav-btn svg {
      width: 16px;
      height: 16px;
      opacity: 0.75;
    }
    .nav-btn span {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .nav-btn.active {
      border-color: var(--accent);
      background: var(--accent-soft);
      color: var(--text-main);
    }
    .nav-btn.active svg {
      opacity: 1;
    }

    @media (min-width: 768px) {
      header {
        padding-top: 20px;
      }
      .card {
        padding: 14px;
      }
      .card-header h2 {
        font-size: 1.05rem;
      }
      table {
        font-size: 0.8rem;
      }
      input.small-input {
        max-width: 64px;
      }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header>
      <div class="title-block">
        <h1>Yearly Life Betterment</h1>
        <span>All your 2026 trackers in one phone app</span>
      </div>
      <div class="pill">
        <div class="pill-dot"></div>
        <span>Offline · Stored on this device</span>
      </div>
    </header>

    <main>
      <div class="group-strip" id="groupStrip"></div>
      <div class="tab-strip" id="tabStrip"></div>
      <section id="screenContainer"></section>
    </main>
  </div>

  <nav class="bottom-nav" id="bottomNav"></nav>

  <script>
    const STORAGE_KEY = "bettermentTracker_v3";

    /* ---- CONFIG: GROUPS + TABS (match your Excel tabs logically) ---- */
    const appConfig = {
      groups: [
        {
          id: "life",
          label: "Life & Reflection",
          icon: "life",
          tabs: [
            { id: "week_tracker", label: "Week Tracker", type: "weekGrid" },
            { id: "personal_tracker", label: "Daily Personal", type: "log_personal" },
            { id: "highlights", label: "Weekly Wins", type: "log_highlights" },
            { id: "month_view", label: "Month View", type: "log_month" }
          ]
        },
        {
          id: "health",
          label: "Health & Fitness",
          icon: "health",
          tabs: [
            { id: "weight_fitness", label: "Weight & Steps", type: "log_weight" },
            { id: "mammoth", label: "Mammoth Tracker", type: "log_mammoth" }
          ]
        },
        {
          id: "disc",
          label: "Disc Golf",
          icon: "disc",
          tabs: [
            { id: "dg_practice", label: "Practice Log", type: "log_dg_practice" },
            { id: "dg_round", label: "Round Log", type: "log_dg_round" },
            { id: "dg_tournament", label: "Tournament Log", type: "log_dg_tournament" },
            { id: "vetsdg", label: "Vets DG Outreach", type: "log_vetsdg" }
          ]
        },
        {
          id: "youtube",
          label: "YouTube",
          icon: "youtube",
          tabs: [
            { id: "yt_tracker", label: "YouTube Tracker", type: "log_youtube" },
            { id: "yt_ideas", label: "Video Ideas", type: "log_yt_ideas" },
            { id: "yt_long_template", label: "Long Script Notes", type: "template_long" },
            { id: "yt_short_template", label: "Short Script Notes", type: "template_short" }
          ]
        },
        {
          id: "skills",
          label: "Skills & Certs",
          icon: "skills",
          tabs: [
            { id: "guitar", label: "Guitar Practice", type: "log_guitar" },
            { id: "certs", label: "Certs Tracker", type: "log_certs" }
          ]
        }
      ],
      weekly: {
        days: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
        rows: [
          { id: "strength", label: "Strength", summary: "Strength Workouts Done" },
          { id: "walk", label: "Walk", summary: "Walk Days Done" },
          { id: "hike", label: "Hike (Long)", summary: "Total Miles" },
          { id: "weight", label: "Weight" },
          { id: "dg_practice", label: "DG Practice", summary: "Disc Golf Practice" },
          { id: "dg_round", label: "DG Round/Tournament", summary: "Disc Golf Rounds" },
          { id: "vets_local", label: "Vets Local" },
          { id: "vets_national", label: "Vets National" },
          { id: "guitar", label: "Guitar Practice" },
          { id: "crisc", label: "CRISC Study" },
          { id: "pmp", label: "PMP Study - Starts Q3" },
          { id: "water", label: "Water" },
          { id: "snacks", label: "Snacks" },
          { id: "sleep", label: "Sleep" },
          { id: "yt_plan", label: "YT Plan" },
          { id: "yt_shoot", label: "YT Shoot" },
          { id: "yt_edit", label: "YT Edit" },
          { id: "yt_upload", label: "YT Upload" },
          { id: "mental_reset", label: "Mental Reset" },
          { id: "mm_distance", label: "MM Distance" },
          { id: "mm_pack_weight", label: "MM Pack Weight" }
        ]
      }
    };

    /* YouTube subcategory options from Lists tab */
    const ytVideoTypeOptions = ["Long", "Short"];
    const ytCategoryOptions = [
      "1 - Skill",
      "2 - Gear",
      "3 - Course",
      "4 - Tournament",
      "5 - Lifestyle",
      "6 - Challenge",
      "7 - ShortVideos"
    ];
    const ytSubcategoryOptions = [
      "1a - Beginner Tips",
      "1b - Putting",
      "1c - Forehand",
      "1d - Backhand",
      "1e - Approach",
      "1f - Form Fix",
      "1g - Wind Play",
      "2a - Disc Review",
      "2b - Bag Setup",
      "2c - Starter Discs",
      "2d - Gear Review",
      "2e - Course Gear",
      "2f - Brand Comparison",
      "3a - Course",
      "3b - Course Review",
      "3c - Walkthrough",
      "3d - Round Breakdown",
      "3e - Field Work",
      "4a - Tournament",
      "4b - Tournament Vlog",
      "5a - Lifestyle",
      "5b - Vet Disc Golf",
      "5c - Mental Game",
      "6 - Challenge",
      "6a - Challenge",
      "6b - Putting Challenge",
      "6c - Fieldwork Challenge",
      "6d - Rating my Round",
      "6e - 30-Day Challenge",
      "6f - Disc Battle",
      "7 - ShortVideos",
      "7a - Quick Tips",
      "7b - Drill",
      "7c - Disc Review (Short)",
      "7d - Motivation",
      "7e - Inspiring Shot",
      "7f - Fail/Funny",
      "7g - Teaser"
    ];

    /* Build flat tab config map */
    const tabConfigs = {};
    appConfig.groups.forEach(group => {
      group.tabs.forEach(tab => {
        tab.groupId = group.id;
        tabConfigs[tab.id] = tab;
      });
    });

    /* ---- STATE MANAGEMENT ---- */
    function loadState() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        if (!raw) return {};
        return JSON.parse(raw);
      } catch (e) {
        console.warn("Failed to parse saved state", e);
        return {};
      }
    }

    function saveState() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(appState));
      } catch (e) {
        console.warn("Failed to save state", e);
      }
    }

    function ensureDefaults(state) {
      if (!state || typeof state !== "object") state = {};
      if (!state.views) state.views = {};
      if (!state.activeGroup) state.activeGroup = "life";
      if (!state.activeTab) state.activeTab = "week_tracker";

      Object.values(tabConfigs).forEach(tab => {
        if (!state[tab.id]) {
          if (tab.type === "weekGrid") {
            state[tab.id] = { weekLabel: "This Week", data: {} };
          } else {
            state[tab.id] = { entries: [] };
          }
        }
      });
      return state;
    }

    let appState = ensureDefaults(loadState());

    /* ---- CSV EXPORT HELPERS ---- */
    function csvEscape(val) {
      if (val === null || val === undefined) return "";
      const s = String(val);
      if (/[",\r\n]/.test(s)) {
        return '"' + s.replace(/"/g, '""') + '"';
      }
      return s;
    }

    function exportCsv(headers, rows, filename) {
      const lines = [];
      lines.push(headers.map(csvEscape).join(","));
      rows.forEach(row => {
        lines.push(row.map(csvEscape).join(","));
      });
      const blob = new Blob([lines.join("\r\n")], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    /* ---- NAV RENDERING ---- */
    function iconSvg(kind) {
      if (kind === "life") {
        return `
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M5 20h14M5 10h14M5 4h14" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path>
          </svg>`;
      }
      if (kind === "health") {
        return `
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 21s-6-4.35-9-8.4C1 9 2.5 5.5 6 5.5c2 0 3.5 1.5 3.9 2.1C10.5 7 12 5.5 14 5.5c3.5 0 5 3.5 3 7.1-3 4.05-9 8.4-9 8.4z" fill="none" stroke="currentColor" stroke-width="2"></path>
          </svg>`;
      }
      if (kind === "disc") {
        return `
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <ellipse cx="12" cy="7" rx="8" ry="3" fill="none" stroke="currentColor" stroke-width="2"></ellipse>
            <path d="M4 7v6c0 1.66 3.58 3 8 3s8-1.34 8-3V7" fill="none" stroke="currentColor" stroke-width="2"></path>
            <path d="M4 13v4c0 1.66 3.58 3 8 3s8-1.34 8-3v-4" fill="none" stroke="currentColor" stroke-width="2"></path>
          </svg>`;
      }
      if (kind === "youtube") {
        return `
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M4 7.5C4 6.12 5.12 5 6.5 5h11C18.88 5 20 6.12 20 7.5v9c0 1.38-1.12 2.5-2.5 2.5h-11C5.12 19 4 17.88 4 16.5v-9z" fill="none" stroke="currentColor" stroke-width="2"></path>
            <path d="M10 9l5 3-5 3V9z" fill="currentColor"></path>
          </svg>`;
      }
      if (kind === "skills") {
        return `
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 3l2.09 4.24L19 8.27l-3.5 3.41L16.18 17 12 14.9 7.82 17l.68-5.32L5 8.27l4.91-1.03L12 3z" fill="none" stroke="currentColor" stroke-width="2"></path>
          </svg>`;
      }
      return `
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"></circle>
        </svg>`;
    }

    function renderGroupNav() {
      const groupStrip = document.getElementById("groupStrip");
      groupStrip.innerHTML = "";
      appConfig.groups.forEach(group => {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "group-chip" + (group.id === appState.activeGroup ? " active" : "");
        btn.textContent = group.label;
        btn.addEventListener("click", () => {
          setActiveGroup(group.id);
        });
        groupStrip.appendChild(btn);
      });
    }

    function renderTabNav() {
      const tabStrip = document.getElementById("tabStrip");
      tabStrip.innerHTML = "";
      const group = appConfig.groups.find(g => g.id === appState.activeGroup) || appConfig.groups[0];
      group.tabs.forEach(tab => {
        const chip = document.createElement("button");
        chip.type = "button";
        chip.className = "tab-chip" + (tab.id === appState.activeTab ? " active" : "");
        chip.textContent = tab.label;
        chip.addEventListener("click", () => {
          setActiveTab(tab.id);
        });
        tabStrip.appendChild(chip);
      });
    }

    function renderBottomNav() {
      const bottomNav = document.getElementById("bottomNav");
      bottomNav.innerHTML = "";
      appConfig.groups.forEach(group => {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "nav-btn" + (group.id === appState.activeGroup ? " active" : "");
        btn.innerHTML = iconSvg(group.icon) + `<span>${group.label}</span>`;
        btn.addEventListener("click", () => {
          setActiveGroup(group.id);
        });
        bottomNav.appendChild(btn);
      });
    }

    function setActiveGroup(groupId) {
      appState.activeGroup = groupId;
      const group = appConfig.groups.find(g => g.id === groupId) || appConfig.groups[0];
      const firstTabId = group.tabs[0].id;
      if (!appState.activeTab || tabConfigs[appState.activeTab].groupId !== groupId) {
        appState.activeTab = firstTabId;
      }
      saveState();
      renderGroupNav();
      renderTabNav();
      renderBottomNav();
      renderScreen();
    }

    function setActiveTab(tabId) {
      if (!tabConfigs[tabId]) return;
      appState.activeTab = tabId;
      appState.activeGroup = tabConfigs[tabId].groupId;
      saveState();
      renderGroupNav();
      renderTabNav();
      renderBottomNav();
      renderScreen();
    }

    /* ---- UTIL: analytics helpers ---- */
    function toNumber(val) {
      const n = parseFloat(val);
      return isNaN(n) ? 0 : n;
    }

    function avg(nums) {
      const filtered = nums.filter(n => !isNaN(n));
      if (!filtered.length) return 0;
      return filtered.reduce((a, b) => a + b, 0) / filtered.length;
    }

    /* ---- SCREEN RENDERING ---- */
    function renderScreen() {
      const container = document.getElementById("screenContainer");
      const activeTabId = appState.activeTab;
      const tabConfig = tabConfigs[activeTabId];
      if (!tabConfig) {
        container.innerHTML = "<p style='padding:12px;font-size:0.85rem;color:var(--text-muted);'>No tab selected.</p>";
        return;
      }

      let node;
      switch (tabConfig.type) {
        case "weekGrid":
          node = renderWeekTracker();
          break;
        case "log_personal":
          node = renderPersonalTracker();
          break;
        case "log_highlights":
          node = renderHighlights();
          break;
        case "log_month":
          node = renderMonthView();
          break;
        case "log_weight":
          node = renderWeightFitness();
          break;
        case "log_mammoth":
          node = renderMammoth();
          break;
        case "log_dg_practice":
          node = renderDGPractice();
          break;
        case "log_dg_round":
          node = renderDGRound();
          break;
        case "log_dg_tournament":
          node = renderDGTournament();
          break;
        case "log_vetsdg":
          node = renderVetsDG();
          break;
        case "log_youtube":
          node = renderYouTubeTracker();
          break;
        case "log_yt_ideas":
          node = renderYTIdeas();
          break;
        case "template_long":
          node = renderYTLongTemplate();
          break;
        case "template_short":
          node = renderYTShortTemplate();
          break;
        case "log_guitar":
          node = renderGuitar();
          break;
        case "log_certs":
          node = renderCerts();
          break;
        default:
          node = document.createElement("div");
          node.innerHTML = "<p style='padding:12px;font-size:0.85rem;color:var(--text-muted);'>Screen not implemented.</p>";
      }

      container.innerHTML = "";
      container.appendChild(node);
    }

    /* ---- WEEK TRACKER (Week_Tracker) ---- */
    function renderWeekTracker() {
      const tabId = "week_tracker";
      const state = appState[tabId];

      const section = document.createElement("section");
      section.className = "card";

      const header = document.createElement("div");
      header.className = "card-header";
      header.innerHTML = `
        <div>
          <h2>Weekly Habit Grid</h2>
          <span>Direct from Week_Tracker tab: categories × days.</span>
        </div>
        <button type="button" class="week-pill" id="weekLabelBtn">
          <span>Week:</span>
          <strong>${state.weekLabel || "This Week"}</strong>
        </button>
      `;
      section.appendChild(header);

      const tableWrapper = document.createElement("div");
      tableWrapper.className = "table-wrapper";

      const table = document.createElement("table");
      const thead = document.createElement("thead");
      const headRow = document.createElement("tr");

      const firstTh = document.createElement("th");
      firstTh.textContent = "Category";
      headRow.appendChild(firstTh);

      appConfig.weekly.days.forEach(day => {
        const th = document.createElement("th");
        th.textContent = day;
        headRow.appendChild(th);
      });

      const totalTh = document.createElement("th");
      totalTh.textContent = "Weekly Total";
      headRow.appendChild(totalTh);

      thead.appendChild(headRow);
      table.appendChild(thead);

      const tbody = document.createElement("tbody");

      let overallTotal = 0;

      appConfig.weekly.rows.forEach(row => {
        const tr = document.createElement("tr");
        const labelTd = document.createElement("td");
        labelTd.className = "category-label";
        labelTd.innerHTML = row.label + (row.summary ? `<span>${row.summary}</span>` : "");
        tr.appendChild(labelTd);

        let rowTotal = 0;
        appConfig.weekly.days.forEach(day => {
          const td = document.createElement("td");
          const stored = (state.data[row.id] && state.data[row.id][day]) || "";
          const input = document.createElement("input");
          input.type = "number";
          input.inputMode = "decimal";
          input.min = "0";
          input.step = "0.01";
          input.className = "small-input";
          input.value = stored;
          if (stored !== "" && !isNaN(parseFloat(stored))) {
            rowTotal += parseFloat(stored);
          }
          input.addEventListener("input", () => {
            const value = input.value;
            if (!state.data[row.id]) state.data[row.id] = {};
            state.data[row.id][day] = value;
            saveState();
            // Update total cell only (not full re-render)
            const num = parseFloat(value);
            renderScreen(); // simple path: re-render whole screen
          });
          td.appendChild(input);
          tr.appendChild(td);
        });

        overallTotal += rowTotal;

        const totalTd = document.createElement("td");
        totalTd.className = "summary-value";
        totalTd.textContent = rowTotal ? rowTotal.toFixed(2).replace(/\.00$/, "") : "–";
        tr.appendChild(totalTd);
        tbody.appendChild(tr);
      });

      // Summary row
      const summaryTr = document.createElement("tr");
      summaryTr.className = "summary-row";
      const labelTd = document.createElement("td");
      labelTd.className = "summary-label";
      labelTd.textContent = "Overall total (all numeric cells)";
      summaryTr.appendChild(labelTd);

      appConfig.weekly.days.forEach(() => {
        const td = document.createElement("td");
        summaryTr.appendChild(td);
      });
      const valTd = document.createElement("td");
      valTd.className = "summary-value";
      valTd.textContent = overallTotal ? overallTotal.toFixed(2).replace(/\.00$/, "") : "–";
      summaryTr.appendChild(valTd);
      tbody.appendChild(summaryTr);

      table.appendChild(tbody);
      tableWrapper.appendChild(table);
      section.appendChild(tableWrapper);

      const controls = document.createElement("div");
      controls.className = "controls-row";

      const exportBtn = document.createElement("button");
      exportBtn.type = "button";
      exportBtn.className = "btn btn-primary";
      exportBtn.textContent = "Export CSV (Week_Tracker)";
      exportBtn.addEventListener("click", () => {
        const headers = ["Category", ...appConfig.weekly.days, "Weekly Summary"];
        const rows = appConfig.weekly.rows.map(row => {
          const rowData = [row.label];
          appConfig.weekly.days.forEach(day => {
            const val = (state.data[row.id] && state.data[row.id][day]) || "";
            rowData.push(val);
          });
          rowData.push(row.summary || "");
          return rowData;
        });
        exportCsv(headers, rows, "Week_Tracker.csv");
      });
      controls.appendChild(exportBtn);

      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn btn-danger";
      clearBtn.textContent = "Clear week";
      clearBtn.addEventListener("click", () => {
        if (confirm("Clear all values for this week?")) {
          appState[tabId] = { weekLabel: state.weekLabel, data: {} };
          saveState();
          renderScreen();
        }
      });
      controls.appendChild(clearBtn);

      section.appendChild(controls);

      const helper = document.createElement("div");
      helper.className = "helper-text";
      helper.innerHTML = `
        <div class="helper-dot"></div>
        <div>
          Use this like your Week_Tracker sheet. Each row is a habit/metric, columns are days.
          Analytics below will pull totals from here for other logs or just for a quick glance.
        </div>
      `;
      section.appendChild(helper);

      const analytics = document.createElement("div");
      analytics.className = "analytics-grid";
      analytics.innerHTML = `
        <div class="analytics-card">
          <div class="analytics-label">Total numeric entries</div>
          <div class="analytics-value">${overallTotal ? overallTotal.toFixed(1) : "0.0"}</div>
        </div>
        <div class="analytics-card">
          <div class="analytics-label">Tracked categories</div>
          <div class="analytics-value">${appConfig.weekly.rows.length}</div>
        </div>
      `;
      section.appendChild(analytics);

      setTimeout(() => {
        const weekBtn = document.getElementById("weekLabelBtn");
        if (weekBtn) {
          weekBtn.addEventListener("click", () => {
            const current = state.weekLabel || "This Week";
            const next = prompt("Set a label for this week (e.g., 'Week 1 · Jan 1–7'):", current);
            if (next !== null && next.trim() !== "") {
              state.weekLabel = next.trim();
              saveState();
              renderScreen();
            }
          });
        }
      }, 0);

      return section;
    }

    /* ---- GENERIC LOG RENDERERS ---- */
    function makeDateInput(value, onChange) {
      const input = document.createElement("input");
      input.type = "date";
      input.className = "log-input";
      input.value = value || "";
      input.addEventListener("input", () => onChange(input.value));
      return input;
    }

    function makeTextInput(value, placeholder, onChange) {
      const input = document.createElement("input");
      input.type = "text";
      input.className = "log-input";
      if (placeholder) input.placeholder = placeholder;
      input.value = value || "";
      input.addEventListener("input", () => onChange(input.value));
      return input;
    }

    function makeNumberInput(value, step, min, onChange) {
      const input = document.createElement("input");
      input.type = "number";
      input.className = "log-input";
      input.inputMode = "decimal";
      if (step != null) input.step = step;
      if (min != null) input.min = min;
      input.value = value || "";
      input.addEventListener("input", () => onChange(input.value));
      return input;
    }

    function makeSelect(options, value, onChange) {
      const select = document.createElement("select");
      select.className = "log-input";
      options.forEach(opt => {
        const o = document.createElement("option");
        o.value = opt;
        o.textContent = opt;
        if ((value || "") === opt) o.selected = true;
        select.appendChild(o);
      });
      select.addEventListener("change", () => onChange(select.value));
      return select;
    }

    function makeTextarea(value, placeholder, onChange) {
      const ta = document.createElement("textarea");
      ta.className = "log-input";
      if (placeholder) ta.placeholder = placeholder;
      ta.value = value || "";
      ta.addEventListener("input", () => onChange(ta.value));
      return ta;
    }

    /* ---- PERSONAL_TRACKER ---- */
    function renderPersonalTracker() {
      const tabId = "personal_tracker";
      const state = appState[tabId];

      const section = document.createElement("section");
      section.className = "card";

      const header = document.createElement("div");
      header.className = "card-header";
      const entries = state.entries || [];
      header.innerHTML = `
        <div>
          <h2>Daily Personal Tracker</h2>
          <span>Sleep, stress, energy, mood, gratitude from Personal_Tracker tab.</span>
        </div>
        <div class="badge"><span>${entries.length}</span> days logged</div>
      `;
      section.appendChild(header);

      const tableWrapper = document.createElement("div");
      tableWrapper.className = "table-wrapper";
      const table = document.createElement("table");
      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>Date</th>
          <th>Sleep (hrs)</th>
          <th>Stress (1-5)</th>
          <th>Energy (1-5)</th>
          <th>Mood (1-5)</th>
          <th>Self-Care?</th>
          <th>Movement?</th>
          <th>Screen Time?</th>
          <th>Gratitude</th>
          <th>Intentions</th>
          <th>Wins Today</th>
          <th>Notes</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      entries.forEach((row, idx) => {
        const tr = document.createElement("tr");

        const dateTd = document.createElement("td");
        dateTd.appendChild(makeDateInput(row.date, v => { row.date = v; saveState(); }));
        tr.appendChild(dateTd);

        const sleepTd = document.createElement("td");
        sleepTd.appendChild(makeNumberInput(row.sleep, "0.1", "0", v => { row.sleep = v; saveState(); }));
        tr.appendChild(sleepTd);

        const stressTd = document.createElement("td");
        stressTd.appendChild(makeNumberInput(row.stress, "1", "1", v => { row.stress = v; saveState(); }));
        tr.appendChild(stressTd);

        const energyTd = document.createElement("td");
        energyTd.appendChild(makeNumberInput(row.energy, "1", "1", v => { row.energy = v; saveState(); }));
        tr.appendChild(energyTd);

        const moodTd = document.createElement("td");
        moodTd.appendChild(makeNumberInput(row.mood, "1", "1", v => { row.mood = v; saveState(); }));
        tr.appendChild(moodTd);

        const scTd = document.createElement("td");
        scTd.appendChild(makeSelect(["", "Yes", "No"], row.selfCare, v => { row.selfCare = v; saveState(); }));
        tr.appendChild(scTd);

        const mvTd = document.createElement("td");
        mvTd.appendChild(makeSelect(["", "Yes", "No"], row.movement, v => { row.movement = v; saveState(); }));
        tr.appendChild(mvTd);

        const stTd = document.createElement("td");
        stTd.appendChild(makeSelect(["", "Yes", "No"], row.screenControl, v => { row.screenControl = v; saveState(); }));
        tr.appendChild(stTd);

        const gratTd = document.createElement("td");
        gratTd.appendChild(makeTextInput(row.gratitude, "", v => { row.gratitude = v; saveState(); }));
        tr.appendChild(gratTd);

        const intentTd = document.createElement("td");
        intentTd.appendChild(makeTextInput(row.intentions, "", v => { row.intentions = v; saveState(); }));
        tr.appendChild(intentTd);

        const winsTd = document.createElement("td");
        winsTd.appendChild(makeTextInput(row.winsToday, "", v => { row.winsToday = v; saveState(); }));
        tr.appendChild(winsTd);

        const notesTd = document.createElement("td");
        notesTd.appendChild(makeTextarea(row.notes, "", v => { row.notes = v; saveState(); }));
        tr.appendChild(notesTd);

        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      tableWrapper.appendChild(table);
      section.appendChild(tableWrapper);

      const controls = document.createElement("div");
      controls.className = "controls-row";

      const exportBtn = document.createElement("button");
      exportBtn.type = "button";
      exportBtn.className = "btn btn-primary";
      exportBtn.textContent = "Export CSV (Personal_Tracker)";
      exportBtn.addEventListener("click", () => {
        const headers = [
          "Date", "Sleep (hrs)", "Stress (1-5)", "Energy (1-5)", "Mood (1-5)",
          "Self-Care Completed (Yes/No)", "Daily Movement (Yes/No)", "Screen Time Control (Yes/No)",
          "Gratitude", "Intentions for Tomorrow", "Wins Today", "Notes"
        ];
        const rows = (state.entries || []).map(r => [
          r.date || "",
          r.sleep || "",
          r.stress || "",
          r.energy || "",
          r.mood || "",
          r.selfCare || "",
          r.movement || "",
          r.screenControl || "",
          r.gratitude || "",
          r.intentions || "",
          r.winsToday || "",
          r.notes || ""
        ]);
        exportCsv(headers, rows, "Personal_Tracker.csv");
      });
      controls.appendChild(exportBtn);

      const addBtn = document.createElement("button");
      addBtn.type = "button";
      addBtn.className = "btn btn-primary";
      addBtn.textContent = "Add Day";
      addBtn.addEventListener("click", () => {
        state.entries.push({
          date: "",
          sleep: "",
          stress: "",
          energy: "",
          mood: "",
          selfCare: "",
          movement: "",
          screenControl: "",
          gratitude: "",
          intentions: "",
          winsToday: "",
          notes: ""
        });
        saveState();
        renderScreen();
      });
      controls.appendChild(addBtn);

      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn btn-danger";
      clearBtn.textContent = "Clear All";
      clearBtn.addEventListener("click", () => {
        if (confirm("Clear all personal tracker rows?")) {
          state.entries = [];
          saveState();
          renderScreen();
        }
      });
      controls.appendChild(clearBtn);

      section.appendChild(controls);

      // Analytics
      const sleeps = (state.entries || []).map(r => toNumber(r.sleep));
      const stressVals = (state.entries || []).map(r => toNumber(r.stress));
      const moodVals = (state.entries || []).map(r => toNumber(r.mood));

      const analytics = document.createElement("div");
      analytics.className = "analytics-grid";
      analytics.innerHTML = `
        <div class="analytics-card">
          <div class="analytics-label">Avg Sleep (hrs)</div>
          <div class="analytics-value">${sleeps.length ? avg(sleeps).toFixed(1) : "0.0"}</div>
        </div>
        <div class="analytics-card">
          <div class="analytics-label">Avg Stress (1–5)</div>
          <div class="analytics-value">${stressVals.length ? avg(stressVals).toFixed(1) : "0.0"}</div>
        </div>
        <div class="analytics-card">
          <div class="analytics-label">Avg Mood (1–5)</div>
          <div class="analytics-value">${moodVals.length ? avg(moodVals).toFixed(1) : "0.0"}</div>
        </div>
      `;
      section.appendChild(analytics);

      return section;
    }

    /* ---- HIGHLIGHTS_WINS ---- */
    function renderHighlights() {
      const tabId = "highlights";
      const state = appState[tabId];
      const entries = state.entries || [];

      const section = document.createElement("section");
      section.className = "card";

      const header = document.createElement("div");
      header.className = "card-header";
      header.innerHTML = `
        <div>
          <h2>Weekly Highlights & Wins</h2>
          <span>From Highlights_Wins: one row per week.</span>
        </div>
        <div class="badge"><span>${entries.length}</span> weeks</div>
      `;
      section.appendChild(header);

      const tableWrapper = document.createElement("div");
      tableWrapper.className = "table-wrapper";
      const table = document.createElement("table");
      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>Week Starting</th>
          <th>Biggest Win</th>
          <th>Health/Fitness Win</th>
          <th>Disc Golf Win</th>
          <th>YouTube Win</th>
          <th>Vets DG Win</th>
          <th>Guitar Win</th>
          <th>Mindset Win</th>
          <th>Notes</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      entries.forEach((row, idx) => {
        const tr = document.createElement("tr");

        const dateTd = document.createElement("td");
        dateTd.appendChild(makeDateInput(row.weekStarting, v => { row.weekStarting = v; saveState(); }));
        tr.appendChild(dateTd);

        ["biggestWin","healthWin","dgWin","ytWin","vetsWin","guitarWin","mindsetWin"].forEach(key => {
          const td = document.createElement("td");
          td.appendChild(makeTextInput(row[key], "", v => { row[key] = v; saveState(); }));
          tr.appendChild(td);
        });

        const notesTd = document.createElement("td");
        notesTd.appendChild(makeTextarea(row.notes, "", v => { row.notes = v; saveState(); }));
        tr.appendChild(notesTd);

        tbody.appendChild(tr);
      });

      table.appendChild(tbody);
      tableWrapper.appendChild(table);
      section.appendChild(tableWrapper);

      const controls = document.createElement("div");
      controls.className = "controls-row";

      const exportBtn = document.createElement("button");
      exportBtn.type = "button";
      exportBtn.className = "btn btn-primary";
      exportBtn.textContent = "Export CSV (Highlights_Wins)";
      exportBtn.addEventListener("click", () => {
        const headers = [
          "Week Starting", "Biggest Win", "Health/Fitness Win", "Disc Golf Win",
          "YouTube Win", "Vets DG Win", "Guitar Win", "Mindset Win", "Notes"
        ];
        const rows = (state.entries || []).map(r => [
          r.weekStarting || "",
          r.biggestWin || "",
          r.healthWin || "",
          r.dgWin || "",
          r.ytWin || "",
          r.vetsWin || "",
          r.guitarWin || "",
          r.mindsetWin || "",
          r.notes || ""
        ]);
        exportCsv(headers, rows, "Highlights_Wins.csv");
      });
      controls.appendChild(exportBtn);

      const addBtn = document.createElement("button");
      addBtn.type = "button";
      addBtn.className = "btn btn-primary";
      addBtn.textContent = "Add Week";
      addBtn.addEventListener("click", () => {
        state.entries.push({
          weekStarting: "",
          biggestWin: "",
          healthWin: "",
          dgWin: "",
          ytWin: "",
          vetsWin: "",
          guitarWin: "",
          mindsetWin: "",
          notes: ""
        });
        saveState();
        renderScreen();
      });
      controls.appendChild(addBtn);

      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn btn-danger";
      clearBtn.textContent = "Clear All";
      clearBtn.addEventListener("click", () => {
        if (confirm("Clear all weekly highlights?")) {
          state.entries = [];
          saveState();
          renderScreen();
        }
      });
      controls.appendChild(clearBtn);

      section.appendChild(controls);

      const analytics = document.createElement("div");
      analytics.className = "analytics-grid";
      analytics.innerHTML = `
        <div class="analytics-card">
          <div class="analytics-label">Weeks captured</div>
          <div class="analytics-value">${entries.length}</div>
        </div>
      `;
      section.appendChild(analytics);

      return section;
    }

    /* ---- MONTH_VIEW ---- */
    function renderMonthView() {
      const tabId = "month_view";
      const state = appState[tabId];
      const entries = state.entries || [];

      const section = document.createElement("section");
      section.className = "card";

      const header = document.createElement("div");
      header.className = "card-header";
      header.innerHTML = `
        <div>
          <h2>Month View</h2>
          <span>From Month_View tab: one row per month.</span>
        </div>
        <div class="badge"><span>${entries.length}</span> months</div>
      `;
      section.appendChild(header);

      const tableWrapper = document.createElement("div");
      tableWrapper.className = "table-wrapper";

      const table = document.createElement("table");
      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>Month</th>
          <th>Overall Grade</th>
          <th>Weight Change (+/- lbs)</th>
          <th>Steps / Miles Total</th>
          <th>DG Sessions (#)</th>
          <th>Putting Avg % (C1/C1X)</th>
          <th>Fieldwork Sessions (#)</th>
          <th>Tournament Results</th>
          <th>Mammoth Distance Total (mi)</th>
          <th>YT Uploads (#)</th>
          <th>YT Avg CTR (%)</th>
          <th>YT Subs Change</th>
          <th>Vet DG Events (#)</th>
          <th>Vet DG Membership Change</th>
          <th>Guitar Practice Hours</th>
          <th>Guitar BPM Progress (+/-)</th>
          <th>Mental Health Avg (1–5)</th>
          <th>Sleep Avg (hrs)</th>
          <th>Stress Avg (1–5)</th>
          <th>Rest Days (#)</th>
          <th>Work/Life Balance (1–5)</th>
          <th>Biggest Wins</th>
          <th>Biggest Challenges</th>
          <th>Lessons Learned</th>
          <th>Adjustments Next Month</th>
          <th>Notes / Reflection</th>
          <th>Monthly Score (0–1)</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      entries.forEach(row => {
        const tr = document.createElement("tr");
        tr.appendChild(makeCell(makeTextInput(row.month, "Jan 2026", v => { row.month = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.grade, "A/B/C", v => { row.grade = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.weightChange, "0.1", "-999", v => { row.weightChange = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.stepsMiles, "", v => { row.stepsMiles = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.dgSessions, "1", "0", v => { row.dgSessions = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.puttingAvg, "C1/C1X", v => { row.puttingAvg = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.fieldworkSessions, "1", "0", v => { row.fieldworkSessions = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.tournResults, "", v => { row.tournResults = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.mammothMiles, "0.1", "0", v => { row.mammothMiles = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.ytUploads, "1", "0", v => { row.ytUploads = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.ytCtr, "0.1", "0", v => { row.ytCtr = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.ytSubsChange, "1", "-999", v => { row.ytSubsChange = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.vetEvents, "1", "0", v => { row.vetEvents = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.vetMembersChange, "1", "-999", v => { row.vetMembersChange = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.guitarHours, "0.1", "0", v => { row.guitarHours = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.guitarBpmDelta, "1", "-999", v => { row.guitarBpmDelta = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.mentalAvg, "0.1", "0", v => { row.mentalAvg = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.sleepAvg, "0.1", "0", v => { row.sleepAvg = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.stressAvg, "0.1", "0", v => { row.stressAvg = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.restDays, "1", "0", v => { row.restDays = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.workLifeScore, "0.1", "0", v => { row.workLifeScore = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.bigWins, "", v => { row.bigWins = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.challenges, "", v => { row.challenges = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.lessons, "", v => { row.lessons = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.adjustments, "", v => { row.adjustments = v; saveState(); })));
        tr.appendChild(makeCell(makeTextarea(row.notes, "", v => { row.notes = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.monthScore, "0.01", "0", v => { row.monthScore = v; saveState(); })));
        tbody.appendChild(tr);
      });

      table.appendChild(tbody);
      tableWrapper.appendChild(table);
      section.appendChild(tableWrapper);

      const controls = document.createElement("div");
      controls.className = "controls-row";

      const exportBtn = document.createElement("button");
      exportBtn.type = "button";
      exportBtn.className = "btn btn-primary";
      exportBtn.textContent = "Export CSV (Month_View)";
      exportBtn.addEventListener("click", () => {
        const headers = [
          "Month","Overall Grade","Weight Change (+/- lbs)","Steps / Miles Total","Disc Golf Sessions (#)",
          "Putting Avg % (C1/C1X)","Fieldwork Sessions (#)","Tournament Results (text)","Mammoth Distance Total (mi)",
          "YouTube Uploads (#)","YouTube Avg CTR (%)","YouTube Subs Change","Vet DG Events (#)","Vet DG Membership Change",
          "Guitar Practice Hours","Guitar BPM Progress (+/-)","Mental Health Avg (1–5)","Sleep Avg (hrs)",
          "Stress Avg (1–5)","Rest Days (#)","Work/Life Balance Score (1–5)","Biggest Wins","Biggest Challenges",
          "Lessons Learned","Adjustments for Next Month","Notes / Reflection","Monthly Score (0–1)"
        ];
        const rows = (state.entries || []).map(r => [
          r.month || "", r.grade || "", r.weightChange || "", r.stepsMiles || "", r.dgSessions || "",
          r.puttingAvg || "", r.fieldworkSessions || "", r.tournResults || "", r.mammothMiles || "",
          r.ytUploads || "", r.ytCtr || "", r.ytSubsChange || "", r.vetEvents || "", r.vetMembersChange || "",
          r.guitarHours || "", r.guitarBpmDelta || "", r.mentalAvg || "", r.sleepAvg || "",
          r.stressAvg || "", r.restDays || "", r.workLifeScore || "", r.bigWins || "", r.challenges || "",
          r.lessons || "", r.adjustments || "", r.notes || "", r.monthScore || ""
        ]);
        exportCsv(headers, rows, "Month_View.csv");
      });
      controls.appendChild(exportBtn);

      const addBtn = document.createElement("button");
      addBtn.type = "button";
      addBtn.className = "btn btn-primary";
      addBtn.textContent = "Add Month";
      addBtn.addEventListener("click", () => {
        state.entries.push({});
        saveState();
        renderScreen();
      });
      controls.appendChild(addBtn);

      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn btn-danger";
      clearBtn.textContent = "Clear All";
      clearBtn.addEventListener("click", () => {
        if (confirm("Clear all month rows?")) {
          state.entries = [];
          saveState();
          renderScreen();
        }
      });
      controls.appendChild(clearBtn);

      section.appendChild(controls);

      const analytics = document.createElement("div");
      analytics.className = "analytics-grid";
      const monthScores = entries.map(r => toNumber(r.monthScore));
      analytics.innerHTML = `
        <div class="analytics-card">
          <div class="analytics-label">Months tracked</div>
          <div class="analytics-value">${entries.length}</div>
        </div>
        <div class="analytics-card">
          <div class="analytics-label">Avg Monthly Score (0–1)</div>
          <div class="analytics-value">${monthScores.length ? avg(monthScores).toFixed(2) : "0.00"}</div>
        </div>
      `;
      section.appendChild(analytics);

      return section;
    }

    function makeCell(child) {
      const td = document.createElement("td");
      td.appendChild(child);
      return td;
    }

    /* ---- WEIGHT_FITNESS ---- */
    function renderWeightFitness() {
      const tabId = "weight_fitness";
      const state = appState[tabId];
      const entries = state.entries || [];

      const section = document.createElement("section");
      section.className = "card";

      const header = document.createElement("div");
      header.className = "card-header";
      header.innerHTML = `
        <div>
          <h2>Weight & Fitness</h2>
          <span>From Weight_Fitness: daily weight, steps, walks, workouts.</span>
        </div>
        <div class="badge"><span>${entries.length}</span> days</div>
      `;
      section.appendChild(header);

      const tableWrapper = document.createElement("div");
      tableWrapper.className = "table-wrapper";
      const table = document.createElement("table");
      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>Date</th>
          <th>Weight</th>
          <th>Steps</th>
          <th>Did You Walk</th>
          <th>Miles</th>
          <th>Did You Workout</th>
          <th>Total Calories</th>
          <th>Notes</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      entries.forEach(row => {
        const tr = document.createElement("tr");
        tr.appendChild(makeCell(makeDateInput(row.date, v => { row.date = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.weight, "0.1", "0", v => { row.weight = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.steps, "1", "0", v => { row.steps = v; saveState(); })));
        tr.appendChild(makeCell(makeSelect(["", "Yes", "No"], row.didWalk, v => { row.didWalk = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.miles, "0.1", "0", v => { row.miles = v; saveState(); })));
        tr.appendChild(makeCell(makeSelect(["", "Yes", "No"], row.didWorkout, v => { row.didWorkout = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.calories, "1", "0", v => { row.calories = v; saveState(); })));
        tr.appendChild(makeCell(makeTextarea(row.notes, "", v => { row.notes = v; saveState(); })));
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      tableWrapper.appendChild(table);
      section.appendChild(tableWrapper);

      const controls = document.createElement("div");
      controls.className = "controls-row";

      const exportBtn = document.createElement("button");
      exportBtn.type = "button";
      exportBtn.className = "btn btn-primary";
      exportBtn.textContent = "Export CSV (Weight_Fitness)";
      exportBtn.addEventListener("click", () => {
        const headers = ["Date","Weight","Steps","Did You Walk","Miles","Did You Workout","Total Calories","Notes"];
        const rows = (state.entries || []).map(r => [
          r.date || "", r.weight || "", r.steps || "", r.didWalk || "", r.miles || "",
          r.didWorkout || "", r.calories || "", r.notes || ""
        ]);
        exportCsv(headers, rows, "Weight_Fitness.csv");
      });
      controls.appendChild(exportBtn);

      const addBtn = document.createElement("button");
      addBtn.type = "button";
      addBtn.className = "btn btn-primary";
      addBtn.textContent = "Add Day";
      addBtn.addEventListener("click", () => {
        state.entries.push({});
        saveState();
        renderScreen();
      });
      controls.appendChild(addBtn);

      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn btn-danger";
      clearBtn.textContent = "Clear All";
      clearBtn.addEventListener("click", () => {
        if (confirm("Clear all weight/fitness rows?")) {
          state.entries = [];
          saveState();
          renderScreen();
        }
      });
      controls.appendChild(clearBtn);

      section.appendChild(controls);

      const weights = entries.map(r => toNumber(r.weight));
      const miles = entries.map(r => toNumber(r.miles));
      const steps = entries.map(r => toNumber(r.steps));

      const analytics = document.createElement("div");
      analytics.className = "analytics-grid";
      analytics.innerHTML = `
        <div class="analytics-card">
          <div class="analytics-label">Avg Weight</div>
          <div class="analytics-value">${weights.length ? avg(weights).toFixed(1) : "0.0"}</div>
        </div>
        <div class="analytics-card">
          <div class="analytics-label">Total Miles</div>
          <div class="analytics-value">${miles.length ? miles.reduce((a,b)=>a+b,0).toFixed(1) : "0.0"}</div>
        </div>
        <div class="analytics-card">
          <div class="analytics-label">Avg Steps</div>
          <div class="analytics-value">${steps.length ? Math.round(avg(steps)) : "0"}</div>
        </div>
      `;
      section.appendChild(analytics);

      return section;
    }

    /* ---- MAMMOTH_TRACKER ---- */
    function renderMammoth() {
      const tabId = "mammoth";
      const state = appState[tabId];
      const entries = state.entries || [];

      const section = document.createElement("section");
      section.className = "card";

      const header = document.createElement("div");
      header.className = "card-header";
      header.innerHTML = `
        <div>
          <h2>Mammoth March Tracker</h2>
          <span>From Mammoth_Tracker: weekly long hike, miles, pack, conditions.</span>
        </div>
        <div class="badge"><span>${entries.length}</span> weeks</div>
      `;
      section.appendChild(header);

      const tableWrapper = document.createElement("div");
      tableWrapper.className = "table-wrapper";
      const table = document.createElement("table");
      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>Week #</th>
          <th>Long Hike Goal (mi)</th>
          <th>Actual Long Distance (mi)</th>
          <th>Goal Hit?</th>
          <th>Total Miles (Week)</th>
          <th>Pack Weight (lb)</th>
          <th>Hydration</th>
          <th>Fuel Tested</th>
          <th>Terrain</th>
          <th>Blisters (Y/N)</th>
          <th>Gear Notes</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      entries.forEach(row => {
        const tr = document.createElement("tr");
        tr.appendChild(makeCell(makeNumberInput(row.week, "1", "1", v => { row.week = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.goalLong, "0.1", "0", v => { row.goalLong = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.actualLong, "0.1", "0", v => { row.actualLong = v; saveState(); })));
        tr.appendChild(makeCell(makeSelect(["","Yes","No"], row.goalHit, v => { row.goalHit = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.totalMilesWeek, "0.1", "0", v => { row.totalMilesWeek = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.packWeight, "0.5", "0", v => { row.packWeight = v; saveState(); })));
        tr.appendChild(makeCell(makeSelect(["","Good","OK","Poor"], row.hydration, v => { row.hydration = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.fuelTested, "", v => { row.fuelTested = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.terrain, "", v => { row.terrain = v; saveState(); })));
        tr.appendChild(makeCell(makeSelect(["","Y","N"], row.blisters, v => { row.blisters = v; saveState(); })));
        tr.appendChild(makeCell(makeTextarea(row.gearNotes, "", v => { row.gearNotes = v; saveState(); })));
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      tableWrapper.appendChild(table);
      section.appendChild(tableWrapper);

      const controls = document.createElement("div");
      controls.className = "controls-row";

      const exportBtn = document.createElement("button");
      exportBtn.type = "button";
      exportBtn.className = "btn btn-primary";
      exportBtn.textContent = "Export CSV (Mammoth_Tracker)";
      exportBtn.addEventListener("click", () => {
        const headers = [
          "Week #","Long Hike Goal","Actual Long Day Distance","Goal Hit",
          "Total Miles for the Week","Pack Weight (lb)","Hydration (Good/OK/Poor)",
          "Fuel Tested","Terrain","Blisters (Y/N)","Gear Notes"
        ];
        const rows = (state.entries || []).map(r => [
          r.week || "", r.goalLong || "", r.actualLong || "", r.goalHit || "",
          r.totalMilesWeek || "", r.packWeight || "", r.hydration || "",
          r.fuelTested || "", r.terrain || "", r.blisters || "", r.gearNotes || ""
        ]);
        exportCsv(headers, rows, "Mammoth_Tracker.csv");
      });
      controls.appendChild(exportBtn);

      const addBtn = document.createElement("button");
      addBtn.type = "button";
      addBtn.className = "btn btn-primary";
      addBtn.textContent = "Add Week";
      addBtn.addEventListener("click", () => {
        state.entries.push({});
        saveState();
        renderScreen();
      });
      controls.appendChild(addBtn);

      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn btn-danger";
      clearBtn.textContent = "Clear All";
      clearBtn.addEventListener("click", () => {
        if (confirm("Clear all Mammoth tracker rows?")) {
          state.entries = [];
          saveState();
          renderScreen();
        }
      });
      controls.appendChild(clearBtn);

      section.appendChild(controls);

      const weeklyMiles = entries.map(r => toNumber(r.totalMilesWeek));
      const analytics = document.createElement("div");
      analytics.className = "analytics-grid";
      analytics.innerHTML = `
        <div class="analytics-card">
          <div class="analytics-label">Total Mammoth Miles</div>
          <div class="analytics-value">${weeklyMiles.length ? weeklyMiles.reduce((a,b)=>a+b,0).toFixed(1) : "0.0"}</div>
        </div>
        <div class="analytics-card">
          <div class="analytics-label">Weeks Logged</div>
          <div class="analytics-value">${entries.length}</div>
        </div>
      `;
      section.appendChild(analytics);

      return section;
    }

    /* ---- DISC GOLF LOGS ---- */
    function renderDGPractice() {
      const tabId = "dg_practice";
      const state = appState[tabId];
      const entries = state.entries || [];

      const section = document.createElement("section");
      section.className = "card";
      const header = document.createElement("div");
      header.className = "card-header";
      header.innerHTML = `
        <div>
          <h2>DG Practice Log</h2>
          <span>From DG Practice Log: field work, putting, reps.</span>
        </div>
        <div class="badge"><span>${entries.length}</span> sessions</div>
      `;
      section.appendChild(header);

      const tableWrapper = document.createElement("div");
      tableWrapper.className = "table-wrapper";
      const table = document.createElement("table");
      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>Date</th>
          <th>Duration (min)</th>
          <th>Session Type</th>
          <th>Focus Skill</th>
          <th>Discs Used</th>
          <th>C1 Att</th>
          <th>C1 Made</th>
          <th>C2 Att</th>
          <th>C2 Made</th>
          <th>FH Reps</th>
          <th>BH Reps</th>
          <th>Fieldwork Notes</th>
          <th>Wind</th>
          <th>Fatigue</th>
          <th>Result</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      entries.forEach(row => {
        const tr = document.createElement("tr");
        tr.appendChild(makeCell(makeDateInput(row.date, v => { row.date = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.duration, "1", "0", v => { row.duration = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.sessionType, "Putting/Fieldwork", v => { row.sessionType = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.focusSkill, "C1, FH, etc.", v => { row.focusSkill = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.discs, "", v => { row.discs = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.c1Att, "1", "0", v => { row.c1Att = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.c1Made, "1", "0", v => { row.c1Made = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.c2Att, "1", "0", v => { row.c2Att = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.c2Made, "1", "0", v => { row.c2Made = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.fhReps, "1", "0", v => { row.fhReps = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.bhReps, "1", "0", v => { row.bhReps = v; saveState(); })));
        tr.appendChild(makeCell(makeTextarea(row.notes, "", v => { row.notes = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.wind, "", v => { row.wind = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.fatigue, "", v => { row.fatigue = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.result, "", v => { row.result = v; saveState(); })));
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      tableWrapper.appendChild(table);
      section.appendChild(tableWrapper);

      const controls = document.createElement("div");
      controls.className = "controls-row";

      const exportBtn = document.createElement("button");
      exportBtn.type = "button";
      exportBtn.className = "btn btn-primary";
      exportBtn.textContent = "Export CSV (DG Practice Log)";
      exportBtn.addEventListener("click", () => {
        const headers = [
          "Date","Duration (min)","Session Type","Focus Skill","Discs Used",
          "C1 Attempts","C1 Made","C2 Attempts","C2 Made","Forehand Reps","Backhand Reps",
          "Fieldwork Notes","Wind","Fatigue","Result"
        ];
        const rows = (state.entries || []).map(r => [
          r.date || "", r.duration || "", r.sessionType || "", r.focusSkill || "",
          r.discs || "", r.c1Att || "", r.c1Made || "", r.c2Att || "", r.c2Made || "",
          r.fhReps || "", r.bhReps || "", r.notes || "", r.wind || "", r.fatigue || "", r.result || ""
        ]);
        exportCsv(headers, rows, "DG Practice Log.csv");
      });
      controls.appendChild(exportBtn);

      const addBtn = document.createElement("button");
      addBtn.type = "button";
      addBtn.className = "btn btn-primary";
      addBtn.textContent = "Add Practice";
      addBtn.addEventListener("click", () => {
        state.entries.push({});
        saveState();
        renderScreen();
      });
      controls.appendChild(addBtn);

      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn btn-danger";
      clearBtn.textContent = "Clear All";
      clearBtn.addEventListener("click", () => {
        if (confirm("Clear all DG practice rows?")) {
          state.entries = [];
          saveState();
          renderScreen();
        }
      });
      controls.appendChild(clearBtn);

      section.appendChild(controls);

      const totalPractice = entries.map(r => toNumber(r.duration)).reduce((a,b)=>a+b,0);
      const analytics = document.createElement("div");
      analytics.className = "analytics-grid";
      analytics.innerHTML = `
        <div class="analytics-card">
          <div class="analytics-label">Total Practice Minutes</div>
          <div class="analytics-value">${totalPractice.toFixed(0)}</div>
        </div>
        <div class="analytics-card">
          <div class="analytics-label">Sessions Logged</div>
          <div class="analytics-value">${entries.length}</div>
        </div>
      `;
      section.appendChild(analytics);

      return section;
    }

    function renderDGRound() {
      const tabId = "dg_round";
      const state = appState[tabId];
      const entries = state.entries || [];

      const section = document.createElement("section");
      section.className = "card";
      const header = document.createElement("div");
      header.className = "card-header";
      header.innerHTML = `
        <div>
          <h2>DG Round Log</h2>
          <span>From DG Round Log: course, layout, score, C1/C2 stats.</span>
        </div>
        <div class="badge"><span>${entries.length}</span> rounds</div>
      `;
      section.appendChild(header);

      const tableWrapper = document.createElement("div");
      tableWrapper.className = "table-wrapper";
      const table = document.createElement("table");
      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>Date</th>
          <th>Course</th>
          <th>Layout</th>
          <th>Total Holes</th>
          <th>Par</th>
          <th>Score</th>
          <th>Diff to Par</th>
          <th>C1% (0-33ft)</th>
          <th>C1X % (6-33ft)</th>
          <th>C2 %</th>
          <th>Misses &lt;20ft</th>
          <th>Penalties</th>
          <th>OBs</th>
          <th>Lost Discs</th>
          <th>Wind</th>
          <th>Notes</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      entries.forEach(row => {
        const tr = document.createElement("tr");
        tr.appendChild(makeCell(makeDateInput(row.date, v => { row.date = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.course, "", v => { row.course = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.layout, "", v => { row.layout = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.totalHoles, "1", "1", v => { row.totalHoles = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.par, "1", "0", v => { row.par = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.score, "1", "-999", v => { row.score = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.diffToPar, "1", "-999", v => { row.diffToPar = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.c1Pct, "0.1", "0", v => { row.c1Pct = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.c1xPct, "0.1", "0", v => { row.c1xPct = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.c2Pct, "0.1", "0", v => { row.c2Pct = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.miss20, "1", "0", v => { row.miss20 = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.penalties, "1", "0", v => { row.penalties = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.obs, "1", "0", v => { row.obs = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.lostDiscs, "1", "0", v => { row.lostDiscs = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.wind, "", v => { row.wind = v; saveState(); })));
        tr.appendChild(makeCell(makeTextarea(row.notes, "", v => { row.notes = v; saveState(); })));
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      tableWrapper.appendChild(table);
      section.appendChild(tableWrapper);

      const controls = document.createElement("div");
      controls.className = "controls-row";

      const exportBtn = document.createElement("button");
      exportBtn.type = "button";
      exportBtn.className = "btn btn-primary";
      exportBtn.textContent = "Export CSV (DG Round Log)";
      exportBtn.addEventListener("click", () => {
        const headers = [
          "Date","Course","Layout","Total Holes","Par","Score","Diff to Par",
          "C1% (0-33ft)","C1X % 6-33ft","C2 %","Misses inside 20ft",
          "Penalties","OBs","Lost Discs","Wind","Notes"
        ];
        const rows = (state.entries || []).map(r => [
          r.date || "", r.course || "", r.layout || "", r.totalHoles || "", r.par || "",
          r.score || "", r.diffToPar || "", r.c1Pct || "", r.c1xPct || "", r.c2Pct || "",
          r.miss20 || "", r.penalties || "", r.obs || "", r.lostDiscs || "", r.wind || "", r.notes || ""
        ]);
        exportCsv(headers, rows, "DG Round Log.csv");
      });
      controls.appendChild(exportBtn);

      const addBtn = document.createElement("button");
      addBtn.type = "button";
      addBtn.className = "btn btn-primary";
      addBtn.textContent = "Add Round";
      addBtn.addEventListener("click", () => {
        state.entries.push({});
        saveState();
        renderScreen();
      });
      controls.appendChild(addBtn);

      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn btn-danger";
      clearBtn.textContent = "Clear All";
      clearBtn.addEventListener("click", () => {
        if (confirm("Clear all DG round rows?")) {
          state.entries = [];
          saveState();
          renderScreen();
        }
      });
      controls.appendChild(clearBtn);

      section.appendChild(controls);

      const scores = entries.map(r => toNumber(r.score));
      const analytics = document.createElement("div");
      analytics.className = "analytics-grid";
      analytics.innerHTML = `
        <div class="analytics-card">
          <div class="analytics-label">Rounds Logged</div>
          <div class="analytics-value">${entries.length}</div>
        </div>
        <div class="analytics-card">
          <div class="analytics-label">Avg Score</div>
          <div class="analytics-value">${scores.length ? avg(scores).toFixed(1) : "0.0"}</div>
        </div>
      `;
      section.appendChild(analytics);

      return section;
    }

    function renderDGTournament() {
      const tabId = "dg_tournament";
      const state = appState[tabId];
      const entries = state.entries || [];

      const section = document.createElement("section");
      section.className = "card";
      const header = document.createElement("div");
      header.className = "card-header";
      header.innerHTML = `
        <div>
          <h2>DG Tournament Log</h2>
          <span>From DG Tournament Log: events, divisions, placing, putting stats.</span>
        </div>
        <div class="badge"><span>${entries.length}</span> events</div>
      `;
      section.appendChild(header);

      const tableWrapper = document.createElement("div");
      tableWrapper.className = "table-wrapper";
      const table = document.createElement("table");
      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>Date</th>
          <th>Event</th>
          <th>Course(s)</th>
          <th>Division</th>
          <th>Round Scores</th>
          <th>Total Participants</th>
          <th>Place</th>
          <th>C1X %</th>
          <th>C1 %</th>
          <th>C2 %</th>
          <th>Missed Inside 20ft</th>
          <th>Notes</th>
          <th>Takeaways</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      entries.forEach(row => {
        const tr = document.createElement("tr");
        tr.appendChild(makeCell(makeDateInput(row.date, v => { row.date = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.event, "", v => { row.event = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.courses, "", v => { row.courses = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.division, "", v => { row.division = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.roundScores, "e.g. 57/54", v => { row.roundScores = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.totalPlayers, "1", "0", v => { row.totalPlayers = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.place, "e.g. 5/32", v => { row.place = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.c1x, "0.1", "0", v => { row.c1x = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.c1, "0.1", "0", v => { row.c1 = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.c2, "0.1", "0", v => { row.c2 = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.miss20, "1", "0", v => { row.miss20 = v; saveState(); })));
        tr.appendChild(makeCell(makeTextarea(row.notes, "", v => { row.notes = v; saveState(); })));
        tr.appendChild(makeCell(makeTextarea(row.takeaways, "", v => { row.takeaways = v; saveState(); })));
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      tableWrapper.appendChild(table);
      section.appendChild(tableWrapper);

      const controls = document.createElement("div");
      controls.className = "controls-row";

      const exportBtn = document.createElement("button");
      exportBtn.type = "button";
      exportBtn.className = "btn btn-primary";
      exportBtn.textContent = "Export CSV (DG Tournament Log)";
      exportBtn.addEventListener("click", () => {
        const headers = [
          "Date","Event","Course(s)","Division","Round Scores","Total Participants",
          "Place","C1X %","C1 %","C2 %","Missed Inside 20ft","Notes","Takeaways"
        ];
        const rows = (state.entries || []).map(r => [
          r.date || "", r.event || "", r.courses || "", r.division || "", r.roundScores || "",
          r.totalPlayers || "", r.place || "", r.c1x || "", r.c1 || "", r.c2 || "",
          r.miss20 || "", r.notes || "", r.takeaways || ""
        ]);
        exportCsv(headers, rows, "DG Tournament Log.csv");
      });
      controls.appendChild(exportBtn);

      const addBtn = document.createElement("button");
      addBtn.type = "button";
      addBtn.className = "btn btn-primary";
      addBtn.textContent = "Add Event";
      addBtn.addEventListener("click", () => {
        state.entries.push({});
        saveState();
        renderScreen();
      });
      controls.appendChild(addBtn);

      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn btn-danger";
      clearBtn.textContent = "Clear All";
      clearBtn.addEventListener("click", () => {
        if (confirm("Clear all DG tournament rows?")) {
          state.entries = [];
          saveState();
          renderScreen();
        }
      });
      controls.appendChild(clearBtn);

      section.appendChild(controls);

      const analytics = document.createElement("div");
      analytics.className = "analytics-grid";
      analytics.innerHTML = `
        <div class="analytics-card">
          <div class="analytics-label">Events Logged</div>
          <div class="analytics-value">${entries.length}</div>
        </div>
      `;
      section.appendChild(analytics);

      return section;
    }

    /* ---- VetsDG_Tracker ---- */
    function renderVetsDG() {
      const tabId = "vetsdg";
      const state = appState[tabId];
      const entries = state.entries || [];

      const section = document.createElement("section");
      section.className = "card";
      const header = document.createElement("div");
      header.className = "card-header";
      header.innerHTML = `
        <div>
          <h2>Vets DG Outreach</h2>
          <span>From VetsDG_Tracker: events, sponsors, attendance, donations.</span>
        </div>
        <div class="badge"><span>${entries.length}</span> entries</div>
      `;
      section.appendChild(header);

      const tableWrapper = document.createElement("div");
      tableWrapper.className = "table-wrapper";
      const table = document.createElement("table");
      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>Date</th>
          <th>Entry Type</th>
          <th>Event / Organization</th>
          <th>Category</th>
          <th>Sponsors</th>
          <th>Outreach</th>
          <th>Attendance</th>
          <th>Donation</th>
          <th>Contact Status</th>
          <th>Notes</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      entries.forEach(row => {
        const tr = document.createElement("tr");
        tr.appendChild(makeCell(makeDateInput(row.date, v => { row.date = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.entryType, "Event/Meeting", v => { row.entryType = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.eventName, "", v => { row.eventName = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.category, "", v => { row.category = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.sponsors, "", v => { row.sponsors = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.outreach, "", v => { row.outreach = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.attendance, "1", "0", v => { row.attendance = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.donation, "1", "0", v => { row.donation = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.contactStatus, "", v => { row.contactStatus = v; saveState(); })));
        tr.appendChild(makeCell(makeTextarea(row.notes, "", v => { row.notes = v; saveState(); })));
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      tableWrapper.appendChild(table);
      section.appendChild(tableWrapper);

      const controls = document.createElement("div");
      controls.className = "controls-row";

      const exportBtn = document.createElement("button");
      exportBtn.type = "button";
      exportBtn.className = "btn btn-primary";
      exportBtn.textContent = "Export CSV (VetsDG_Tracker)";
      exportBtn.addEventListener("click", () => {
        const headers = [
          "Date","Entry Type","Event Name/Organization","Category","Sponsors",
          "Outreach","Attendance","Donation","Contact Status","Notes"
        ];
        const rows = (state.entries || []).map(r => [
          r.date || "", r.entryType || "", r.eventName || "", r.category || "",
          r.sponsors || "", r.outreach || "", r.attendance || "", r.donation || "",
          r.contactStatus || "", r.notes || ""
        ]);
        exportCsv(headers, rows, "VetsDG_Tracker.csv");
      });
      controls.appendChild(exportBtn);

      const addBtn = document.createElement("button");
      addBtn.type = "button";
      addBtn.className = "btn btn-primary";
      addBtn.textContent = "Add Entry";
      addBtn.addEventListener("click", () => {
        state.entries.push({});
        saveState();
        renderScreen();
      });
      controls.appendChild(addBtn);

      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn btn-danger";
      clearBtn.textContent = "Clear All";
      clearBtn.addEventListener("click", () => {
        if (confirm("Clear all Vets DG entries?")) {
          state.entries = [];
          saveState();
          renderScreen();
        }
      });
      controls.appendChild(clearBtn);

      section.appendChild(controls);

      const donations = entries.map(r => toNumber(r.donation));
      const analytics = document.createElement("div");
      analytics.className = "analytics-grid";
      analytics.innerHTML = `
        <div class="analytics-card">
          <div class="analytics-label">Total Donation</div>
          <div class="analytics-value">$${donations.length ? donations.reduce((a,b)=>a+b,0).toFixed(2) : "0.00"}</div>
        </div>
        <div class="analytics-card">
          <div class="analytics-label">Total Attendance</div>
          <div class="analytics-value">${entries.map(r => toNumber(r.attendance)).reduce((a,b)=>a+b,0)}</div>
        </div>
      `;
      section.appendChild(analytics);

      return section;
    }

    /* ---- YOUTUBE_TRACKER ---- */
    function renderYouTubeTracker() {
      const tabId = "yt_tracker";
      const state = appState[tabId];
      const entries = state.entries || [];

      const section = document.createElement("section");
      section.className = "card";
      const header = document.createElement("div");
      header.className = "card-header";

      const uploadedCount = entries.filter(e => e.uploadDate).length;
      header.innerHTML = `
        <div>
          <h2>YouTube Tracker</h2>
          <span>From YouTube_Tracker tab: planning + analytics per video. Subcategory uses Lists tab.</span>
        </div>
        <div class="badge"><span>${uploadedCount}</span> with upload date / ${entries.length} rows</div>
      `;
      section.appendChild(header);

      const tableWrapper = document.createElement("div");
      tableWrapper.className = "table-wrapper";
      const table = document.createElement("table");
      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>Week#</th>
          <th>Title</th>
          <th>Upload Date</th>
          <th>Length</th>
          <th>Video Type</th>
          <th>Category</th>
          <th>Subcategory</th>
          <th>Hook</th>
          <th>Thumbnail</th>
          <th>Topic</th>
          <th>CTR %</th>
          <th>Avg View Duration</th>
          <th>Avg View %</th>
          <th>7 Day View</th>
          <th>Total View</th>
          <th>Sub Change</th>
          <th>Video Score</th>
          <th>Notes</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      entries.forEach(row => {
        const tr = document.createElement("tr");
        tr.appendChild(makeCell(makeNumberInput(row.week, "1", "1", v => { row.week = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.title, "", v => { row.title = v; saveState(); })));
        tr.appendChild(makeCell(makeDateInput(row.uploadDate, v => { row.uploadDate = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.length, "10:00", v => { row.length = v; saveState(); })));
        tr.appendChild(makeCell(makeSelect(ytVideoTypeOptions, row.videoType, v => { row.videoType = v; saveState(); })));
        tr.appendChild(makeCell(makeSelect(ytCategoryOptions, row.category, v => { row.category = v; saveState(); })));
        tr.appendChild(makeCell(makeSelect(ytSubcategoryOptions, row.subcategory, v => { row.subcategory = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.hook, "", v => { row.hook = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.thumbnail, "", v => { row.thumbnail = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.topic, "", v => { row.topic = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.ctr, "0.1", "0", v => { row.ctr = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.avgViewDur, "0.1", "0", v => { row.avgViewDur = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.avgViewPct, "0.1", "0", v => { row.avgViewPct = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.view7, "1", "0", v => { row.view7 = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.totalView, "1", "0", v => { row.totalView = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.subChange, "1", "-999", v => { row.subChange = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.videoScore, "0.01", "0", v => { row.videoScore = v; saveState(); })));
        tr.appendChild(makeCell(makeTextarea(row.notes, "", v => { row.notes = v; saveState(); })));
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      tableWrapper.appendChild(table);
      section.appendChild(tableWrapper);

      const controls = document.createElement("div");
      controls.className = "controls-row";

      const exportBtn = document.createElement("button");
      exportBtn.type = "button";
      exportBtn.className = "btn btn-primary";
      exportBtn.textContent = "Export CSV (YouTube_Tracker)";
      exportBtn.addEventListener("click", () => {
        const headers = [
          "Week#","Title","Upload Date","Length","Video Type","Category","Subcategory","Hook","Thumbnail",
          "Topic","CTR %","Average View Duration","Average View %","7 Day View","Total View","Sub Change",
          "Video Score","Notes"
        ];
        const rows = (state.entries || []).map(r => [
          r.week || "", r.title || "", r.uploadDate || "", r.length || "",
          r.videoType || "", r.category || "", r.subcategory || "", r.hook || "",
          r.thumbnail || "", r.topic || "", r.ctr || "", r.avgViewDur || "", r.avgViewPct || "",
          r.view7 || "", r.totalView || "", r.subChange || "", r.videoScore || "", r.notes || ""
        ]);
        exportCsv(headers, rows, "YouTube_Tracker.csv");
      });
      controls.appendChild(exportBtn);

      const addBtn = document.createElement("button");
      addBtn.type = "button";
      addBtn.className = "btn btn-primary";
      addBtn.textContent = "Add Video Row";
      addBtn.addEventListener("click", () => {
        state.entries.push({
          videoType: ytVideoTypeOptions[0],
          category: ytCategoryOptions[0],
          subcategory: ytSubcategoryOptions[0]
        });
        saveState();
        renderScreen();
      });
      controls.appendChild(addBtn);

      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn btn-danger";
      clearBtn.textContent = "Clear All";
      clearBtn.addEventListener("click", () => {
        if (confirm("Clear all YouTube tracker rows?")) {
          state.entries = [];
          saveState();
          renderScreen();
        }
      });
      controls.appendChild(clearBtn);

      section.appendChild(controls);

      const ctrs = entries.map(r => toNumber(r.ctr));
      const vidScores = entries.map(r => toNumber(r.videoScore));
      const totalViews = entries.map(r => toNumber(r.totalView)).reduce((a,b)=>a+b,0);
      const subs = entries.map(r => toNumber(r.subChange)).reduce((a,b)=>a+b,0);

      const analytics = document.createElement("div");
      analytics.className = "analytics-grid";
      analytics.innerHTML = `
        <div class="analytics-card">
          <div class="analytics-label">Avg CTR %</div>
          <div class="analytics-value">${ctrs.length ? avg(ctrs).toFixed(1) : "0.0"}</div>
        </div>
        <div class="analytics-card">
          <div class="analytics-label">Total Views</div>
          <div class="analytics-value">${totalViews}</div>
        </div>
        <div class="analytics-card">
          <div class="analytics-label">Total Sub Change</div>
          <div class="analytics-value">${subs}</div>
        </div>
        <div class="analytics-card">
          <div class="analytics-label">Avg Video Score</div>
          <div class="analytics-value">${vidScores.length ? avg(vidScores).toFixed(2) : "0.00"}</div>
        </div>
      `;
      section.appendChild(analytics);

      return section;
    }

    /* ---- Youtube Video Ideas ---- */
    function renderYTIdeas() {
      const tabId = "yt_ideas";
      const state = appState[tabId];
      const entries = state.entries || [];

      const section = document.createElement("section");
      section.className = "card";
      const header = document.createElement("div");
      header.className = "card-header";
      header.innerHTML = `
        <div>
          <h2>YouTube Video Ideas</h2>
          <span>From Youtube Video Ideas tab: grouped idea buckets.</span>
        </div>
        <div class="badge"><span>${entries.length}</span> rows</div>
      `;
      section.appendChild(header);

      const tableWrapper = document.createElement("div");
      tableWrapper.className = "table-wrapper";
      const table = document.createElement("table");
      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>Skill Tutorial</th>
          <th>Gear Review</th>
          <th>Course Gear</th>
          <th>Lifestyle</th>
          <th>Beginner Tips</th>
          <th>Challenge</th>
          <th>Experimentation</th>
          <th>Quick Tip</th>
          <th>20 Video Ideas</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      entries.forEach(row => {
        const tr = document.createElement("tr");
        ["skill","gear","courseGear","lifestyle","beginner","challenge","experimentation","quick","ideas"].forEach((key, idx) => {
          const td = document.createElement("td");
          td.appendChild(makeTextarea(row[key], "", v => { row[key] = v; saveState(); }));
          tr.appendChild(td);
        });
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      tableWrapper.appendChild(table);
      section.appendChild(tableWrapper);

      const controls = document.createElement("div");
      controls.className = "controls-row";

      const exportBtn = document.createElement("button");
      exportBtn.type = "button";
      exportBtn.className = "btn btn-primary";
      exportBtn.textContent = "Export CSV (Youtube Video Ideas)";
      exportBtn.addEventListener("click", () => {
        const headers = [
          "Skill Tutorial","Gear Review","Course Gear","Lifestyle",
          "Beginner Tips","Challenge","Experimentation","Quick Tip","20 Video Ideas"
        ];
        const rows = (state.entries || []).map(r => [
          r.skill || "", r.gear || "", r.courseGear || "", r.lifestyle || "",
          r.beginner || "", r.challenge || "", r.experimentation || "", r.quick || "", r.ideas || ""
        ]);
        exportCsv(headers, rows, "Youtube Video Ideas.csv");
      });
      controls.appendChild(exportBtn);

      const addBtn = document.createElement("button");
      addBtn.type = "button";
      addBtn.className = "btn btn-primary";
      addBtn.textContent = "Add Row";
      addBtn.addEventListener("click", () => {
        state.entries.push({});
        saveState();
        renderScreen();
      });
      controls.appendChild(addBtn);

      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn btn-danger";
      clearBtn.textContent = "Clear All";
      clearBtn.addEventListener("click", () => {
        if (confirm("Clear all idea rows?")) {
          state.entries = [];
          saveState();
          renderScreen();
        }
      });
      controls.appendChild(clearBtn);

      section.appendChild(controls);

      const analytics = document.createElement("div");
      analytics.className = "analytics-grid";
      analytics.innerHTML = `
        <div class="analytics-card">
          <div class="analytics-label">Idea rows</div>
          <div class="analytics-value">${entries.length}</div>
        </div>
      `;
      section.appendChild(analytics);

      return section;
    }

    /* ---- Script Templates (Long/Short) ---- */
    function renderYTLongTemplate() {
      return renderTemplateGeneric("yt_long_template", "Long Script Notes", "Long Script Template", "Example");
    }
    function renderYTShortTemplate() {
      return renderTemplateGeneric("yt_short_template", "Short Script Notes", "Template", "Example of Template");
    }

    function renderTemplateGeneric(tabId, title, col1Name, col2Name) {
      const state = appState[tabId];
      const entries = state.entries || [];

      const section = document.createElement("section");
      section.className = "card";
      const header = document.createElement("div");
      header.className = "card-header";
      header.innerHTML = `
        <div>
          <h2>${title}</h2>
          <span>Use this to store your favorite script patterns and examples.</span>
        </div>
        <div class="badge"><span>${entries.length}</span> rows</div>
      `;
      section.appendChild(header);

      const tableWrapper = document.createElement("div");
      tableWrapper.className = "table-wrapper";
      const table = document.createElement("table");
      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>${col1Name}</th>
          <th>${col2Name}</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      entries.forEach(row => {
        const tr = document.createElement("tr");
        tr.appendChild(makeCell(makeTextarea(row.template, "", v => { row.template = v; saveState(); })));
        tr.appendChild(makeCell(makeTextarea(row.example, "", v => { row.example = v; saveState(); })));
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      tableWrapper.appendChild(table);
      section.appendChild(tableWrapper);

      const controls = document.createElement("div");
      controls.className = "controls-row";

      const exportBtn = document.createElement("button");
      exportBtn.type = "button";
      exportBtn.className = "btn btn-primary";
      exportBtn.textContent = "Export CSV";
      exportBtn.addEventListener("click", () => {
        const headers = [col1Name, col2Name];
        const rows = (state.entries || []).map(r => [r.template || "", r.example || ""]);
        exportCsv(headers, rows, title.replace(/\s+/g,"_") + ".csv");
      });
      controls.appendChild(exportBtn);

      const addBtn = document.createElement("button");
      addBtn.type = "button";
      addBtn.className = "btn btn-primary";
      addBtn.textContent = "Add Row";
      addBtn.addEventListener("click", () => {
        state.entries.push({});
        saveState();
        renderScreen();
      });
      controls.appendChild(addBtn);

      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn btn-danger";
      clearBtn.textContent = "Clear All";
      clearBtn.addEventListener("click", () => {
        if (confirm("Clear all rows?")) {
          state.entries = [];
          saveState();
          renderScreen();
        }
      });
      controls.appendChild(clearBtn);

      section.appendChild(controls);

      return section;
    }

    /* ---- GuitarPractice_Tracker ---- */
    function renderGuitar() {
      const tabId = "guitar";
      const state = appState[tabId];
      const entries = state.entries || [];

      const section = document.createElement("section");
      section.className = "card";
      const header = document.createElement("div");
      header.className = "card-header";
      header.innerHTML = `
        <div>
          <h2>Guitar Practice Tracker</h2>
          <span>From GuitarPractice_Tracker: focus, BPM, difficulty, notes.</span>
        </div>
        <div class="badge"><span>${entries.length}</span> sessions</div>
      `;
      section.appendChild(header);

      const tableWrapper = document.createElement("div");
      tableWrapper.className = "table-wrapper";
      const table = document.createElement("table");
      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>Date</th>
          <th>Practice Length (mins)</th>
          <th>Focus Area</th>
          <th>Technique Skill</th>
          <th>BPM Goal</th>
          <th>BPM Achieved</th>
          <th>BPM Success %</th>
          <th>Song/Exercise</th>
          <th>Difficulty (1-5)</th>
          <th>Feeling</th>
          <th>Notes</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      entries.forEach(row => {
        const tr = document.createElement("tr");
        tr.appendChild(makeCell(makeDateInput(row.date, v => { row.date = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.length, "1", "0", v => { row.length = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.focus, "", v => { row.focus = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.technique, "", v => { row.technique = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.bpmGoal, "1", "0", v => { row.bpmGoal = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.bpmAchieved, "1", "0", v => { row.bpmAchieved = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.bpmSuccess, "0.1", "0", v => { row.bpmSuccess = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.song, "", v => { row.song = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.difficulty, "1", "1", v => { row.difficulty = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.feeling, "", v => { row.feeling = v; saveState(); })));
        tr.appendChild(makeCell(makeTextarea(row.notes, "", v => { row.notes = v; saveState(); })));
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      tableWrapper.appendChild(table);
      section.appendChild(tableWrapper);

      const controls = document.createElement("div");
      controls.className = "controls-row";

      const exportBtn = document.createElement("button");
      exportBtn.type = "button";
      exportBtn.className = "btn btn-primary";
      exportBtn.textContent = "Export CSV (GuitarPractice_Tracker)";
      exportBtn.addEventListener("click", () => {
        const headers = [
          "Date","Practice Length (mins)","Focus Area","Technique Skill","BPM Goal",
          "BPM Achieved","BPM Success %","Song/Exercise","Difficulty (1-5)","Feeling","Notes"
        ];
        const rows = (state.entries || []).map(r => [
          r.date || "", r.length || "", r.focus || "", r.technique || "", r.bpmGoal || "",
          r.bpmAchieved || "", r.bpmSuccess || "", r.song || "", r.difficulty || "", r.feeling || "", r.notes || ""
        ]);
        exportCsv(headers, rows, "GuitarPractice_Tracker.csv");
      });
      controls.appendChild(exportBtn);

      const addBtn = document.createElement("button");
      addBtn.type = "button";
      addBtn.className = "btn btn-primary";
      addBtn.textContent = "Add Session";
      addBtn.addEventListener("click", () => {
        state.entries.push({});
        saveState();
        renderScreen();
      });
      controls.appendChild(addBtn);

      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn btn-danger";
      clearBtn.textContent = "Clear All";
      clearBtn.addEventListener("click", () => {
        if (confirm("Clear all guitar rows?")) {
          state.entries = [];
          saveState();
          renderScreen();
        }
      });
      controls.appendChild(clearBtn);

      section.appendChild(controls);

      const mins = entries.map(r => toNumber(r.length));
      const analytics = document.createElement("div");
      analytics.className = "analytics-grid";
      analytics.innerHTML = `
        <div class="analytics-card">
          <div class="analytics-label">Total Practice Minutes</div>
          <div class="analytics-value">${mins.length ? mins.reduce((a,b)=>a+b,0) : 0}</div>
        </div>
      `;
      section.appendChild(analytics);

      return section;
    }

    /* ---- Certs_Tracker ---- */
    function renderCerts() {
      const tabId = "certs";
      const state = appState[tabId];
      const entries = state.entries || [];

      const section = document.createElement("section");
      section.className = "card";
      const header = document.createElement("div");
      header.className = "card-header";
      header.innerHTML = `
        <div>
          <h2>Certs Tracker</h2>
          <span>From Certs_Tracker: CRISC/PMP domains, study time, scores.</span>
        </div>
        <div class="badge"><span>${entries.length}</span> sessions</div>
      `;
      section.appendChild(header);

      const tableWrapper = document.createElement("div");
      tableWrapper.className = "table-wrapper";
      const table = document.createElement("table");
      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>Date</th>
          <th>Cert</th>
          <th>Domain/Topic</th>
          <th>Study Time (min)</th>
          <th>Practice Qs %</th>
          <th>Practice Exam Name</th>
          <th>Score</th>
          <th>Weak Areas</th>
          <th>Notes</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      entries.forEach(row => {
        const tr = document.createElement("tr");
        tr.appendChild(makeCell(makeDateInput(row.date, v => { row.date = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.cert, "CRISC/PMP", v => { row.cert = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.domain, "", v => { row.domain = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.studyTime, "1", "0", v => { row.studyTime = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.practicePct, "0.1", "0", v => { row.practicePct = v; saveState(); })));
        tr.appendChild(makeCell(makeTextInput(row.examName, "", v => { row.examName = v; saveState(); })));
        tr.appendChild(makeCell(makeNumberInput(row.score, "0.1", "0", v => { row.score = v; saveState(); })));
        tr.appendChild(makeCell(makeTextarea(row.weakAreas, "", v => { row.weakAreas = v; saveState(); })));
        tr.appendChild(makeCell(makeTextarea(row.notes, "", v => { row.notes = v; saveState(); })));
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      tableWrapper.appendChild(table);
      section.appendChild(tableWrapper);

      const controls = document.createElement("div");
      controls.className = "controls-row";

      const exportBtn = document.createElement("button");
      exportBtn.type = "button";
      exportBtn.className = "btn btn-primary";
      exportBtn.textContent = "Export CSV (Certs_Tracker)";
      exportBtn.addEventListener("click", () => {
        const headers = [
          "Date","Cert (CRISC/PMP)","Domain/Topic","Study Time (min)","Practice Qs %","Practice Exam Name","Score","Weak Areas","Notes"
        ];
        const rows = (state.entries || []).map(r => [
          r.date || "", r.cert || "", r.domain || "", r.studyTime || "",
          r.practicePct || "", r.examName || "", r.score || "", r.weakAreas || "", r.notes || ""
        ]);
        exportCsv(headers, rows, "Certs_Tracker.csv");
      });
      controls.appendChild(exportBtn);

      const addBtn = document.createElement("button");
      addBtn.type = "button";
      addBtn.className = "btn btn-primary";
      addBtn.textContent = "Add Session";
      addBtn.addEventListener("click", () => {
        state.entries.push({});
        saveState();
        renderScreen();
      });
      controls.appendChild(addBtn);

      const clearBtn = document.createElement("button");
      clearBtn.type = "button";
      clearBtn.className = "btn btn-danger";
      clearBtn.textContent = "Clear All";
      clearBtn.addEventListener("click", () => {
        if (confirm("Clear all cert rows?")) {
          state.entries = [];
          saveState();
          renderScreen();
        }
      });
      controls.appendChild(clearBtn);

      section.appendChild(controls);

      const studyMinutes = entries.map(r => toNumber(r.studyTime)).reduce((a,b)=>a+b,0);
      const analytics = document.createElement("div");
      analytics.className = "analytics-grid";
      analytics.innerHTML = `
        <div class="analytics-card">
          <div class="analytics-label">Total Study Minutes</div>
          <div class="analytics-value">${studyMinutes}</div>
        </div>
      `;
      section.appendChild(analytics);

      return section;
    }

    /* ---- INIT ---- */
    (function init() {
      renderGroupNav();
      renderTabNav();
      renderBottomNav();
      renderScreen();
    })();
  </script>
</body>
</html>
